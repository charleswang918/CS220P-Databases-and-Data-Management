import unittest
from gradescope_utils.autograder_utils.decorators import weight
import mysql.connector
from decimal import Decimal
from queries import Queries
from constants import Constants

class TestSQLQueries(unittest.TestCase):
    def setUp(self):
        self.connection = mysql.connector.connect(user=Constants.USER, password=Constants.PASSWORD, database=Constants.DATABASE)
        self.cursor = self.connection.cursor()
        self.queries = Queries()

    def tearDown(self):
        self.cursor.close()
        self.connection.close()

    def test_query_view_one(self):
        """Create a view for the ARC administrator called “Top_Machines_Used”."""
        self.cursor.execute("drop view if exists Top_Machines_Used;")
        self.cursor.execute(self.queries.query1)
        self.cursor.execute("select `Equipment Name`,`Total Number of Days Used`,`Number Of Unique Users Using Equipment`,`Rank` from Top_Machines_Used;")

        result_intermediate = [('Weightlifting Gloves', 21, 26, 1), ('Elliptical Trainer', 19, 24, 2), ('Pilates Reformer', 14, 18, 3), ('Adjustable Bench', 14, 18, 3), ('Abdominal Mat', 16, 17, 5), ('Push-up Handles', 14, 17, 5), ('Sandbags', 15, 15, 7), ('Suspension Trainer (TRX)', 11, 13, 8), ('Hand Grippers', 9, 12, 9), ('Rower', 11, 12, 9), ('Step Platform', 13, 12, 9), ('Battle Ropes', 9, 11, 12), ('Hack Squat Machine', 8, 10, 13), ('Vibrating Fitness Roller', 10, 10, 13), ('Hex Bar', 9, 10, 13)]
        
        result = self.cursor.fetchall()
        try:
            self.assertCountEqual(result,result_intermediate,"Incorrect Query")
        except:
            raise Exception("Incorrect Query")

    @weight(25)
    def test_query_view_two(self):
        """Create a view “Machines_Used_By_Day_Of_Week”"""
        self.cursor.execute("drop view if exists Machines_Used_By_Day_Of_Week;")
        self.cursor.execute(self.queries.query2)
        self.cursor.execute("select `Equipment Name`,`Day of Week`,`Type of Member`,`Count` from Machines_Used_By_Day_Of_Week;")
        
        result_intermediate = [('Ab Roller', 'Sunday', 'Computer Science', 1), ('Ab Roller', None, 'Computer Science', 1), ('Ab Roller', 'Wednesday', 'Engineering', 1), ('Ab Roller', None, 'Engineering', 1), ('Ab Roller', 'Thursday', 'Family', 1), ('Ab Roller', None, 'Family', 1), ('Ab Roller', 'Thursday', 'Financial Officer', 1), ('Ab Roller', None, 'Financial Officer', 1), ('Ab Roller', 'Friday', 'IT Support', 1), ('Ab Roller', None, 'IT Support', 1), ('Ab Roller', None, None, 5), ('Abdominal Mat', 'Monday', 'Administrative Staff', 1), ('Abdominal Mat', None, 'Administrative Staff', 1), ('Abdominal Mat', 'Saturday', 'Biology', 1), ('Abdominal Mat', None, 'Biology', 1), ('Abdominal Mat', 'Sunday', 'Computer Science', 1), ('Abdominal Mat', 'Wednesday', 'Computer Science', 1), ('Abdominal Mat', None, 'Computer Science', 2), ('Abdominal Mat', 'Friday', 'Economics', 1), ('Abdominal Mat', 'Saturday', 'Economics', 1), ('Abdominal Mat', 'Sunday', 'Economics', 1), ('Abdominal Mat', None, 'Economics', 3), ('Abdominal Mat', 'Friday', 'Engineering', 1), ('Abdominal Mat', 'Tuesday', 'Engineering', 1), ('Abdominal Mat', None, 'Engineering', 2), ('Abdominal Mat', 'Friday', 'Family', 1), ('Abdominal Mat', 'Saturday', 'Family', 1), ('Abdominal Mat', 'Thursday', 'Family', 1), ('Abdominal Mat', 'Tuesday', 'Family', 2), ('Abdominal Mat', None, 'Family', 5), ('Abdominal Mat', 'Sunday', 'History', 1), ('Abdominal Mat', 'Tuesday', 'History', 1), ('Abdominal Mat', None, 'History', 2), ('Abdominal Mat', 'Saturday', 'Physics', 1), ('Abdominal Mat', 'Sunday', 'Physics', 1), ('Abdominal Mat', 'Tuesday', 'Physics', 1), ('Abdominal Mat', None, 'Physics', 3), ('Abdominal Mat', None, None, 19), ('Adjustable Bench', 'Tuesday', 'Administrative Staff', 1), ('Adjustable Bench', None, 'Administrative Staff', 1), ('Adjustable Bench', 'Saturday', 'Computer Science', 2), ('Adjustable Bench', None, 'Computer Science', 2), ('Adjustable Bench', 'Sunday', 'Economics', 1), ('Adjustable Bench', 'Wednesday', 'Economics', 1), ('Adjustable Bench', None, 'Economics', 2), ('Adjustable Bench', 'Wednesday', 'Engineering', 1), ('Adjustable Bench', None, 'Engineering', 1), ('Adjustable Bench', 'Saturday', 'Family', 2), ('Adjustable Bench', 'Sunday', 'Family', 1), ('Adjustable Bench', 'Tuesday', 'Family', 2), ('Adjustable Bench', None, 'Family', 5), ('Adjustable Bench', 'Tuesday', 'History', 1), ('Adjustable Bench', None, 'History', 1), ('Adjustable Bench', 'Monday', 'Physics', 1), ('Adjustable Bench', 'Saturday', 'Physics', 1), ('Adjustable Bench', None, 'Physics', 2), ('Adjustable Bench', 'Friday', 'Political Science', 1), ('Adjustable Bench', 'Wednesday', 'Political Science', 1), ('Adjustable Bench', None, 'Political Science', 2), ('Adjustable Bench', 'Friday', 'Security Officer', 1), ('Adjustable Bench', 'Monday', 'Security Officer', 1), ('Adjustable Bench', None, 'Security Officer', 2), ('Adjustable Bench', None, None, 18), ('Aerobic Stepper', 'Saturday', 'Computer Science', 1), ('Aerobic Stepper', None, 'Computer Science', 1), ('Aerobic Stepper', 'Wednesday', 'Financial Officer', 1), ('Aerobic Stepper', None, 'Financial Officer', 1), ('Aerobic Stepper', 'Sunday', 'Technician', 1), ('Aerobic Stepper', None, 'Technician', 1), ('Aerobic Stepper', None, None, 3), ('Ankle Weights', 'Thursday', 'Biology', 1), ('Ankle Weights', None, 'Biology', 1), ('Ankle Weights', 'Monday', 'Computer Science', 1), ('Ankle Weights', 'Tuesday', 'Computer Science', 1), ('Ankle Weights', None, 'Computer Science', 2), ('Ankle Weights', 'Sunday', 'Engineering', 1), ('Ankle Weights', None, 'Engineering', 1), ('Ankle Weights', 'Thursday', 'Family', 1), ('Ankle Weights', None, 'Family', 1), ('Ankle Weights', 'Monday', 'IT Support', 1), ('Ankle Weights', 'Thursday', 'IT Support', 1), ('Ankle Weights', None, 'IT Support', 2), ('Ankle Weights', 'Saturday', 'Political Science', 1), ('Ankle Weights', None, 'Political Science', 1), ('Ankle Weights', 'Tuesday', 'Research Assistant', 1), ('Ankle Weights', None, 'Research Assistant', 1), ('Ankle Weights', 'Wednesday', 'Technician', 1), ('Ankle Weights', None, 'Technician', 1), ('Ankle Weights', None, None, 10), ('Arm Curl Machine', 'Monday', 'Engineering', 1), ('Arm Curl Machine', None, 'Engineering', 1), ('Arm Curl Machine', 'Saturday', 'Faculty', 1), ('Arm Curl Machine', None, 'Faculty', 1), ('Arm Curl Machine', 'Monday', 'Family', 1), ('Arm Curl Machine', 'Sunday', 'Family', 1), ('Arm Curl Machine', None, 'Family', 2), ('Arm Curl Machine', 'Monday', 'IT Support', 1), ('Arm Curl Machine', 'Sunday', 'IT Support', 1), ('Arm Curl Machine', None, 'IT Support', 2), ('Arm Curl Machine', 'Friday', 'Physics', 1), ('Arm Curl Machine', None, 'Physics', 1), ('Arm Curl Machine', 'Saturday', 'Security Officer', 1), ('Arm Curl Machine', None, 'Security Officer', 1), ('Arm Curl Machine', None, None, 8), ('Balance Disc', 'Sunday', 'Computer Science', 1), ('Balance Disc', 'Tuesday', 'Computer Science', 1), ('Balance Disc', None, 'Computer Science', 2), ('Balance Disc', 'Monday', 'Economics', 1), ('Balance Disc', 'Tuesday', 'Economics', 1), ('Balance Disc', None, 'Economics', 2), ('Balance Disc', 'Friday', 'Family', 2), ('Balance Disc', None, 'Family', 2), ('Balance Disc', 'Wednesday', 'History', 1), ('Balance Disc', None, 'History', 1), ('Balance Disc', 'Wednesday', 'Physics', 1), ('Balance Disc', None, 'Physics', 1), ('Balance Disc', None, None, 8), ('Battle Ropes', 'Thursday', 'Administrative Staff', 1), ('Battle Ropes', None, 'Administrative Staff', 1), ('Battle Ropes', 'Monday', 'Computer Science', 1), ('Battle Ropes', None, 'Computer Science', 1), ('Battle Ropes', 'Thursday', 'Economics', 1), ('Battle Ropes', None, 'Economics', 1), ('Battle Ropes', 'Wednesday', 'Engineering', 1), ('Battle Ropes', None, 'Engineering', 1), ('Battle Ropes', 'Friday', 'Family', 2), ('Battle Ropes', 'Saturday', 'Family', 1), ('Battle Ropes', None, 'Family', 3), ('Battle Ropes', 'Monday', 'Financial Officer', 1), ('Battle Ropes', None, 'Financial Officer', 1), ('Battle Ropes', 'Sunday', 'IT Support', 1), ('Battle Ropes', None, 'IT Support', 1), ('Battle Ropes', 'Sunday', 'Political Science', 1), ('Battle Ropes', None, 'Political Science', 1), ('Battle Ropes', 'Tuesday', 'Security Officer', 2), ('Battle Ropes', None, 'Security Officer', 2), ('Battle Ropes', None, None, 12), ('Bench Press', 'Saturday', 'Administrative Staff', 1), ('Bench Press', None, 'Administrative Staff', 1), ('Bench Press', 'Friday', 'Economics', 1), ('Bench Press', 'Sunday', 'Economics', 1), ('Bench Press', None, 'Economics', 2), ('Bench Press', 'Friday', 'English Literature', 1), ('Bench Press', 'Sunday', 'English Literature', 1), ('Bench Press', None, 'English Literature', 2), ('Bench Press', 'Monday', 'Family', 1), ('Bench Press', None, 'Family', 1), ('Bench Press', 'Monday', 'Mathematics', 1), ('Bench Press', None, 'Mathematics', 1), ('Bench Press', 'Thursday', 'Physics', 1), ('Bench Press', None, 'Physics', 1), ('Bench Press', 'Monday', 'Political Science', 1), ('Bench Press', None, 'Political Science', 1), ('Bench Press', None, None, 9), ('Bumper Plates', 'Friday', 'English Literature', 1), ('Bumper Plates', None, 'English Literature', 1), ('Bumper Plates', 'Monday', 'Family', 1), ('Bumper Plates', 'Sunday', 'Family', 1), ('Bumper Plates', 'Thursday', 'Family', 1), ('Bumper Plates', 'Wednesday', 'Family', 1), ('Bumper Plates', None, 'Family', 4), ('Bumper Plates', 'Friday', 'Librarian', 1), ('Bumper Plates', None, 'Librarian', 1), ('Bumper Plates', None, None, 6), ('Cable Crossover', 'Thursday', 'Chemistry', 1), ('Cable Crossover', None, 'Chemistry', 1), ('Cable Crossover', 'Tuesday', 'Economics', 1), ('Cable Crossover', None, 'Economics', 1), ('Cable Crossover', 'Wednesday', 'History', 1), ('Cable Crossover', None, 'History', 1), ('Cable Crossover', 'Tuesday', 'Librarian', 1), ('Cable Crossover', None, 'Librarian', 1), ('Cable Crossover', 'Friday', 'Research Assistant', 1), ('Cable Crossover', None, 'Research Assistant', 1), ('Cable Crossover', 'Saturday', 'Security Officer', 1), ('Cable Crossover', None, 'Security Officer', 1), ('Cable Crossover', None, None, 6), ('Elliptical Trainer', 'Sunday', 'Administrative Staff', 1), ('Elliptical Trainer', None, 'Administrative Staff', 1), ('Elliptical Trainer', 'Sunday', 'Biology', 1), ('Elliptical Trainer', None, 'Biology', 1), ('Elliptical Trainer', 'Thursday', 'Chemistry', 1), ('Elliptical Trainer', 'Wednesday', 'Chemistry', 1), ('Elliptical Trainer', None, 'Chemistry', 2), ('Elliptical Trainer', 'Monday', 'Computer Science', 1), ('Elliptical Trainer', 'Thursday', 'Computer Science', 1), ('Elliptical Trainer', 'Tuesday', 'Computer Science', 1), ('Elliptical Trainer', None, 'Computer Science', 3), ('Elliptical Trainer', 'Saturday', 'Economics', 1), ('Elliptical Trainer', None, 'Economics', 1), ('Elliptical Trainer', 'Sunday', 'English Literature', 1), ('Elliptical Trainer', None, 'English Literature', 1), ('Elliptical Trainer', 'Saturday', 'Family', 2), ('Elliptical Trainer', 'Thursday', 'Family', 3), ('Elliptical Trainer', 'Tuesday', 'Family', 3), ('Elliptical Trainer', 'Wednesday', 'Family', 1), ('Elliptical Trainer', None, 'Family', 9), ('Elliptical Trainer', 'Sunday', 'Financial Officer', 2), ('Elliptical Trainer', None, 'Financial Officer', 2), ('Elliptical Trainer', 'Friday', 'History', 1), ('Elliptical Trainer', 'Tuesday', 'History', 1), ('Elliptical Trainer', None, 'History', 2), ('Elliptical Trainer', 'Friday', 'IT Support', 1), ('Elliptical Trainer', None, 'IT Support', 1), ('Elliptical Trainer', 'Sunday', 'Librarian', 1), ('Elliptical Trainer', 'Thursday', 'Librarian', 1), ('Elliptical Trainer', None, 'Librarian', 2), ('Elliptical Trainer', 'Sunday', 'Mathematics', 1), ('Elliptical Trainer', 'Tuesday', 'Mathematics', 1), ('Elliptical Trainer', None, 'Mathematics', 2), ('Elliptical Trainer', 'Thursday', 'Physics', 1), ('Elliptical Trainer', 'Tuesday', 'Physics', 1), ('Elliptical Trainer', 'Wednesday', 'Physics', 1), ('Elliptical Trainer', None, 'Physics', 3), ('Elliptical Trainer', 'Friday', 'Technician', 1), ('Elliptical Trainer', 'Wednesday', 'Technician', 1), ('Elliptical Trainer', None, 'Technician', 2), ('Elliptical Trainer', None, None, 32), ('Grip Strengthener', 'Wednesday', 'Administrative Staff', 1), ('Grip Strengthener', None, 'Administrative Staff', 1), ('Grip Strengthener', 'Tuesday', 'English Literature', 1), ('Grip Strengthener', None, 'English Literature', 1), ('Grip Strengthener', 'Thursday', 'Faculty', 1), ('Grip Strengthener', None, 'Faculty', 1), ('Grip Strengthener', 'Saturday', 'Family', 1), ('Grip Strengthener', 'Sunday', 'Family', 2), ('Grip Strengthener', None, 'Family', 3), ('Grip Strengthener', 'Sunday', 'History', 1), ('Grip Strengthener', None, 'History', 1), ('Grip Strengthener', 'Friday', 'Mathematics', 1), ('Grip Strengthener', None, 'Mathematics', 1), ('Grip Strengthener', 'Friday', 'Physics', 1), ('Grip Strengthener', None, 'Physics', 1), ('Grip Strengthener', 'Saturday', 'Political Science', 1), ('Grip Strengthener', None, 'Political Science', 1), ('Grip Strengthener', None, None, 10), ('Hack Squat Machine', 'Monday', 'Computer Science', 1), ('Hack Squat Machine', None, 'Computer Science', 1), ('Hack Squat Machine', 'Monday', 'Engineering', 1), ('Hack Squat Machine', 'Tuesday', 'Engineering', 1), ('Hack Squat Machine', None, 'Engineering', 2), ('Hack Squat Machine', 'Monday', 'Family', 1), ('Hack Squat Machine', 'Tuesday', 'Family', 1), ('Hack Squat Machine', None, 'Family', 2), ('Hack Squat Machine', 'Sunday', 'History', 1), ('Hack Squat Machine', None, 'History', 1), ('Hack Squat Machine', 'Thursday', 'IT Support', 1), ('Hack Squat Machine', None, 'IT Support', 1), ('Hack Squat Machine', 'Monday', 'Mathematics', 1), ('Hack Squat Machine', None, 'Mathematics', 1), ('Hack Squat Machine', 'Wednesday', 'Physics', 1), ('Hack Squat Machine', None, 'Physics', 1), ('Hack Squat Machine', 'Tuesday', 'Political Science', 1), ('Hack Squat Machine', None, 'Political Science', 1), ('Hack Squat Machine', None, None, 10), ('Hand Grippers', 'Sunday', 'Biology', 1), ('Hand Grippers', None, 'Biology', 1), ('Hand Grippers', 'Monday', 'Chemistry', 1), ('Hand Grippers', None, 'Chemistry', 1), ('Hand Grippers', 'Monday', 'Economics', 1), ('Hand Grippers', None, 'Economics', 1), ('Hand Grippers', 'Monday', 'Family', 1), ('Hand Grippers', 'Thursday', 'Family', 1), ('Hand Grippers', 'Tuesday', 'Family', 1), ('Hand Grippers', None, 'Family', 3), ('Hand Grippers', 'Tuesday', 'Financial Officer', 1), ('Hand Grippers', None, 'Financial Officer', 1), ('Hand Grippers', 'Monday', 'History', 1), ('Hand Grippers', 'Tuesday', 'History', 1), ('Hand Grippers', None, 'History', 2), ('Hand Grippers', 'Sunday', 'Political Science', 1), ('Hand Grippers', None, 'Political Science', 1), ('Hand Grippers', 'Saturday', 'Security Officer', 1), ('Hand Grippers', None, 'Security Officer', 1), ('Hand Grippers', 'Monday', 'Technician', 1), ('Hand Grippers', None, 'Technician', 1), ('Hand Grippers', None, None, 12), ('Hand Weights', 'Thursday', 'Computer Science', 1), ('Hand Weights', 'Wednesday', 'Computer Science', 1), ('Hand Weights', None, 'Computer Science', 2), ('Hand Weights', 'Saturday', 'Family', 1), ('Hand Weights', 'Sunday', 'Family', 1), ('Hand Weights', 'Wednesday', 'Family', 1), ('Hand Weights', None, 'Family', 3), ('Hand Weights', 'Wednesday', 'IT Support', 1), ('Hand Weights', None, 'IT Support', 1), ('Hand Weights', 'Tuesday', 'Librarian', 1), ('Hand Weights', 'Wednesday', 'Librarian', 1), ('Hand Weights', None, 'Librarian', 2), ('Hand Weights', 'Friday', 'Physics', 1), ('Hand Weights', 'Saturday', 'Physics', 1), ('Hand Weights', 'Wednesday', 'Physics', 1), ('Hand Weights', None, 'Physics', 3), ('Hand Weights', None, None, 11), ('Hex Bar', 'Friday', 'Biology', 1), ('Hex Bar', None, 'Biology', 1), ('Hex Bar', 'Friday', 'Economics', 1), ('Hex Bar', 'Saturday', 'Economics', 1), ('Hex Bar', None, 'Economics', 2), ('Hex Bar', 'Thursday', 'Engineering', 1), ('Hex Bar', None, 'Engineering', 1), ('Hex Bar', 'Friday', 'Family', 1), ('Hex Bar', 'Wednesday', 'Family', 1), ('Hex Bar', None, 'Family', 2), ('Hex Bar', 'Friday', 'Financial Officer', 1), ('Hex Bar', None, 'Financial Officer', 1), ('Hex Bar', 'Tuesday', 'History', 1), ('Hex Bar', None, 'History', 1), ('Hex Bar', 'Saturday', 'Physics', 1), ('Hex Bar', None, 'Physics', 1), ('Hex Bar', 'Friday', 'Security Officer', 1), ('Hex Bar', None, 'Security Officer', 1), ('Hex Bar', None, None, 10), ('Leg Press', 'Tuesday', 'Family', 1), ('Leg Press', None, 'Family', 1), ('Leg Press', 'Saturday', 'History', 1), ('Leg Press', None, 'History', 1), ('Leg Press', 'Monday', 'Political Science', 1), ('Leg Press', None, 'Political Science', 1), ('Leg Press', None, None, 3), ('Pilates Reformer', 'Saturday', 'Chemistry', 1), ('Pilates Reformer', 'Wednesday', 'Chemistry', 1), ('Pilates Reformer', None, 'Chemistry', 2), ('Pilates Reformer', 'Tuesday', 'Computer Science', 1), ('Pilates Reformer', None, 'Computer Science', 1), ('Pilates Reformer', 'Tuesday', 'Engineering', 1), ('Pilates Reformer', None, 'Engineering', 1), ('Pilates Reformer', 'Friday', 'Faculty', 1), ('Pilates Reformer', None, 'Faculty', 1), ('Pilates Reformer', 'Saturday', 'Family', 1), ('Pilates Reformer', 'Thursday', 'Family', 2), ('Pilates Reformer', 'Tuesday', 'Family', 1), ('Pilates Reformer', 'Wednesday', 'Family', 1), ('Pilates Reformer', None, 'Family', 5), ('Pilates Reformer', 'Monday', 'Financial Officer', 1), ('Pilates Reformer', None, 'Financial Officer', 1), ('Pilates Reformer', 'Monday', 'History', 1), ('Pilates Reformer', 'Saturday', 'History', 1), ('Pilates Reformer', None, 'History', 2), ('Pilates Reformer', 'Saturday', 'IT Support', 1), ('Pilates Reformer', None, 'IT Support', 1), ('Pilates Reformer', 'Monday', 'Mathematics', 1), ('Pilates Reformer', None, 'Mathematics', 1), ('Pilates Reformer', 'Tuesday', 'Physics', 1), ('Pilates Reformer', None, 'Physics', 1), ('Pilates Reformer', 'Saturday', 'Security Officer', 1), ('Pilates Reformer', None, 'Security Officer', 1), ('Pilates Reformer', 'Thursday', 'Technician', 1), ('Pilates Reformer', None, 'Technician', 1), ('Pilates Reformer', None, None, 18), ('Power Tower', 'Friday', 'Chemistry', 1), ('Power Tower', None, 'Chemistry', 1), ('Power Tower', 'Friday', 'Economics', 2), ('Power Tower', None, 'Economics', 2), ('Power Tower', 'Sunday', 'Engineering', 1), ('Power Tower', None, 'Engineering', 1), ('Power Tower', 'Thursday', 'Faculty', 1), ('Power Tower', None, 'Faculty', 1), ('Power Tower', 'Friday', 'Technician', 1), ('Power Tower', None, 'Technician', 1), ('Power Tower', None, None, 6), ('Prowler Sled', 'Saturday', 'Chemistry', 1), ('Prowler Sled', 'Thursday', 'Chemistry', 1), ('Prowler Sled', None, 'Chemistry', 2), ('Prowler Sled', 'Friday', 'Family', 1), ('Prowler Sled', 'Saturday', 'Family', 1), ('Prowler Sled', 'Sunday', 'Family', 1), ('Prowler Sled', 'Tuesday', 'Family', 1), ('Prowler Sled', None, 'Family', 4), ('Prowler Sled', 'Sunday', 'Librarian', 1), ('Prowler Sled', None, 'Librarian', 1), ('Prowler Sled', 'Friday', 'Physics', 1), ('Prowler Sled', 'Thursday', 'Physics', 1), ('Prowler Sled', None, 'Physics', 2), ('Prowler Sled', 'Thursday', 'Political Science', 1), ('Prowler Sled', 'Wednesday', 'Political Science', 1), ('Prowler Sled', None, 'Political Science', 2), ('Prowler Sled', 'Saturday', 'Security Officer', 1), ('Prowler Sled', None, 'Security Officer', 1), ('Prowler Sled', None, None, 12), ('Pull-up Assist Bands', 'Wednesday', 'Chemistry', 1), ('Pull-up Assist Bands', None, 'Chemistry', 1), ('Pull-up Assist Bands', 'Tuesday', 'Computer Science', 1), ('Pull-up Assist Bands', None, 'Computer Science', 1), ('Pull-up Assist Bands', 'Sunday', 'Engineering', 1), ('Pull-up Assist Bands', None, 'Engineering', 1), ('Pull-up Assist Bands', 'Friday', 'Family', 1), ('Pull-up Assist Bands', 'Saturday', 'Family', 2), ('Pull-up Assist Bands', 'Sunday', 'Family', 1), ('Pull-up Assist Bands', 'Tuesday', 'Family', 1), ('Pull-up Assist Bands', 'Wednesday', 'Family', 1), ('Pull-up Assist Bands', None, 'Family', 6), ('Pull-up Assist Bands', 'Thursday', 'Physics', 1), ('Pull-up Assist Bands', None, 'Physics', 1), ('Pull-up Assist Bands', None, None, 10), ('Push-up Handles', 'Sunday', 'Administrative Staff', 1), ('Push-up Handles', None, 'Administrative Staff', 1), ('Push-up Handles', 'Monday', 'Biology', 1), ('Push-up Handles', 'Wednesday', 'Biology', 1), ('Push-up Handles', None, 'Biology', 2), ('Push-up Handles', 'Tuesday', 'Computer Science', 1), ('Push-up Handles', None, 'Computer Science', 1), ('Push-up Handles', 'Thursday', 'Economics', 1), ('Push-up Handles', 'Tuesday', 'Economics', 2), ('Push-up Handles', None, 'Economics', 3), ('Push-up Handles', 'Saturday', 'Family', 1), ('Push-up Handles', 'Thursday', 'Family', 1), ('Push-up Handles', 'Tuesday', 'Family', 2), ('Push-up Handles', None, 'Family', 4), ('Push-up Handles', 'Sunday', 'Financial Officer', 1), ('Push-up Handles', None, 'Financial Officer', 1), ('Push-up Handles', 'Saturday', 'History', 1), ('Push-up Handles', None, 'History', 1), ('Push-up Handles', 'Wednesday', 'IT Support', 1), ('Push-up Handles', None, 'IT Support', 1), ('Push-up Handles', 'Wednesday', 'Physics', 1), ('Push-up Handles', None, 'Physics', 1), ('Push-up Handles', 'Monday', 'Political Science', 1), ('Push-up Handles', None, 'Political Science', 1), ('Push-up Handles', 'Wednesday', 'Research Assistant', 1), ('Push-up Handles', None, 'Research Assistant', 1), ('Push-up Handles', None, None, 17), ('Resistance Bands', 'Saturday', 'Chemistry', 1), ('Resistance Bands', None, 'Chemistry', 1), ('Resistance Bands', 'Wednesday', 'Economics', 1), ('Resistance Bands', None, 'Economics', 1), ('Resistance Bands', 'Sunday', 'Engineering', 1), ('Resistance Bands', None, 'Engineering', 1), ('Resistance Bands', 'Thursday', 'Financial Officer', 1), ('Resistance Bands', None, 'Financial Officer', 1), ('Resistance Bands', 'Monday', 'Political Science', 1), ('Resistance Bands', 'Sunday', 'Political Science', 1), ('Resistance Bands', None, 'Political Science', 2), ('Resistance Bands', None, None, 6), ('Resistance Loop Bands', 'Friday', 'Administrative Staff', 1), ('Resistance Loop Bands', None, 'Administrative Staff', 1), ('Resistance Loop Bands', 'Friday', 'Engineering', 1), ('Resistance Loop Bands', None, 'Engineering', 1), ('Resistance Loop Bands', 'Wednesday', 'Family', 1), ('Resistance Loop Bands', None, 'Family', 1), ('Resistance Loop Bands', 'Monday', 'IT Support', 1), ('Resistance Loop Bands', None, 'IT Support', 1), ('Resistance Loop Bands', 'Saturday', 'Mathematics', 1), ('Resistance Loop Bands', 'Thursday', 'Mathematics', 1), ('Resistance Loop Bands', None, 'Mathematics', 2), ('Resistance Loop Bands', None, None, 6), ('Roman Chair', 'Tuesday', 'Computer Science', 1), ('Roman Chair', None, 'Computer Science', 1), ('Roman Chair', 'Thursday', 'Economics', 1), ('Roman Chair', None, 'Economics', 1), ('Roman Chair', 'Wednesday', 'Mathematics', 1), ('Roman Chair', None, 'Mathematics', 1), ('Roman Chair', 'Saturday', 'Political Science', 1), ('Roman Chair', None, 'Political Science', 1), ('Roman Chair', 'Sunday', 'Security Officer', 1), ('Roman Chair', None, 'Security Officer', 1), ('Roman Chair', None, None, 5), ('Rower', 'Sunday', 'Biology', 1), ('Rower', None, 'Biology', 1), ('Rower', 'Thursday', 'Computer Science', 1), ('Rower', None, 'Computer Science', 1), ('Rower', 'Friday', 'Engineering', 1), ('Rower', 'Sunday', 'Engineering', 1), ('Rower', None, 'Engineering', 2), ('Rower', 'Sunday', 'Faculty', 1), ('Rower', None, 'Faculty', 1), ('Rower', 'Monday', 'Family', 1), ('Rower', 'Tuesday', 'Family', 1), ('Rower', None, 'Family', 2), ('Rower', 'Saturday', 'Financial Officer', 1), ('Rower', None, 'Financial Officer', 1), ('Rower', 'Sunday', 'History', 2), ('Rower', None, 'History', 2), ('Rower', 'Saturday', 'IT Support', 1), ('Rower', None, 'IT Support', 1), ('Rower', 'Tuesday', 'Political Science', 1), ('Rower', None, 'Political Science', 1), ('Rower', None, None, 12), ('Sandbags', 'Saturday', 'Computer Science', 1), ('Sandbags', None, 'Computer Science', 1), ('Sandbags', 'Sunday', 'Economics', 1), ('Sandbags', None, 'Economics', 1), ('Sandbags', 'Saturday', 'Engineering', 1), ('Sandbags', 'Thursday', 'Engineering', 1), ('Sandbags', 'Tuesday', 'Engineering', 1), ('Sandbags', None, 'Engineering', 3), ('Sandbags', 'Friday', 'Family', 1), ('Sandbags', 'Sunday', 'Family', 2), ('Sandbags', None, 'Family', 3), ('Sandbags', 'Monday', 'History', 1), ('Sandbags', 'Saturday', 'History', 1), ('Sandbags', 'Tuesday', 'History', 1), ('Sandbags', None, 'History', 3), ('Sandbags', 'Monday', 'IT Support', 1), ('Sandbags', 'Tuesday', 'IT Support', 1), ('Sandbags', None, 'IT Support', 2), ('Sandbags', 'Monday', 'Physics', 1), ('Sandbags', 'Sunday', 'Physics', 1), ('Sandbags', 'Thursday', 'Physics', 1), ('Sandbags', None, 'Physics', 3), ('Sandbags', None, None, 16), ('Spin Bike', 'Sunday', 'Computer Science', 1), ('Spin Bike', None, 'Computer Science', 1), ('Spin Bike', 'Monday', 'Family', 1), ('Spin Bike', 'Tuesday', 'Family', 1), ('Spin Bike', None, 'Family', 2), ('Spin Bike', 'Sunday', 'History', 1), ('Spin Bike', None, 'History', 1), ('Spin Bike', 'Sunday', 'Political Science', 1), ('Spin Bike', 'Tuesday', 'Political Science', 1), ('Spin Bike', None, 'Political Science', 2), ('Spin Bike', None, None, 6), ('Squat Rack', 'Friday', 'English Literature', 1), ('Squat Rack', None, 'English Literature', 1), ('Squat Rack', 'Monday', 'Financial Officer', 1), ('Squat Rack', None, 'Financial Officer', 1), ('Squat Rack', 'Monday', 'Physics', 1), ('Squat Rack', 'Saturday', 'Physics', 1), ('Squat Rack', None, 'Physics', 2), ('Squat Rack', 'Sunday', 'Political Science', 1), ('Squat Rack', None, 'Political Science', 1), ('Squat Rack', None, None, 5), ('Stability Ball', 'Sunday', 'Biology', 1), ('Stability Ball', 'Tuesday', 'Biology', 1), ('Stability Ball', None, 'Biology', 2), ('Stability Ball', 'Monday', 'Engineering', 1), ('Stability Ball', None, 'Engineering', 1), ('Stability Ball', 'Saturday', 'Family', 1), ('Stability Ball', None, 'Family', 1), ('Stability Ball', 'Sunday', 'Financial Officer', 1), ('Stability Ball', None, 'Financial Officer', 1), ('Stability Ball', 'Tuesday', 'History', 1), ('Stability Ball', None, 'History', 1), ('Stability Ball', 'Tuesday', 'IT Support', 1), ('Stability Ball', None, 'IT Support', 1), ('Stability Ball', 'Monday', 'Political Science', 1), ('Stability Ball', None, 'Political Science', 1), ('Stability Ball', 'Tuesday', 'Security Officer', 1), ('Stability Ball', None, 'Security Officer', 1), ('Stability Ball', None, None, 9), ('Stationary Bike', 'Saturday', 'Administrative Staff', 1), ('Stationary Bike', 'Sunday', 'Administrative Staff', 1), ('Stationary Bike', None, 'Administrative Staff', 2), ('Stationary Bike', 'Sunday', 'Economics', 1), ('Stationary Bike', 'Wednesday', 'Economics', 1), ('Stationary Bike', None, 'Economics', 2), ('Stationary Bike', 'Friday', 'Family', 1), ('Stationary Bike', 'Monday', 'Family', 1), ('Stationary Bike', 'Sunday', 'Family', 1), ('Stationary Bike', 'Thursday', 'Family', 1), ('Stationary Bike', None, 'Family', 4), ('Stationary Bike', 'Sunday', 'History', 1), ('Stationary Bike', None, 'History', 1), ('Stationary Bike', None, None, 9), ('Step Platform', 'Monday', 'Economics', 1), ('Step Platform', 'Thursday', 'Economics', 2), ('Step Platform', 'Wednesday', 'Economics', 1), ('Step Platform', None, 'Economics', 4), ('Step Platform', 'Monday', 'Engineering', 1), ('Step Platform', 'Saturday', 'Engineering', 1), ('Step Platform', 'Wednesday', 'Engineering', 1), ('Step Platform', None, 'Engineering', 3), ('Step Platform', 'Friday', 'Family', 2), ('Step Platform', 'Monday', 'Family', 1), ('Step Platform', 'Sunday', 'Family', 1), ('Step Platform', 'Wednesday', 'Family', 1), ('Step Platform', None, 'Family', 5), ('Step Platform', 'Friday', 'Financial Officer', 1), ('Step Platform', 'Saturday', 'Financial Officer', 1), ('Step Platform', None, 'Financial Officer', 2), ('Step Platform', 'Monday', 'History', 1), ('Step Platform', None, 'History', 1), ('Step Platform', 'Monday', 'Physics', 1), ('Step Platform', 'Thursday', 'Physics', 1), ('Step Platform', None, 'Physics', 2), ('Step Platform', None, None, 17), ('Suspension Trainer (TRX)', 'Tuesday', 'Administrative Staff', 1), ('Suspension Trainer (TRX)', None, 'Administrative Staff', 1), ('Suspension Trainer (TRX)', 'Monday', 'Computer Science', 1), ('Suspension Trainer (TRX)', None, 'Computer Science', 1), ('Suspension Trainer (TRX)', 'Tuesday', 'Economics', 1), ('Suspension Trainer (TRX)', None, 'Economics', 1), ('Suspension Trainer (TRX)', 'Friday', 'Family', 1), ('Suspension Trainer (TRX)', None, 'Family', 1), ('Suspension Trainer (TRX)', 'Friday', 'History', 1), ('Suspension Trainer (TRX)', 'Sunday', 'History', 1), ('Suspension Trainer (TRX)', 'Thursday', 'History', 1), ('Suspension Trainer (TRX)', None, 'History', 3), ('Suspension Trainer (TRX)', 'Monday', 'IT Support', 1), ('Suspension Trainer (TRX)', 'Thursday', 'IT Support', 1), ('Suspension Trainer (TRX)', None, 'IT Support', 2), ('Suspension Trainer (TRX)', 'Sunday', 'Physics', 1), ('Suspension Trainer (TRX)', 'Tuesday', 'Physics', 1), ('Suspension Trainer (TRX)', None, 'Physics', 2), ('Suspension Trainer (TRX)', 'Friday', 'Political Science', 1), ('Suspension Trainer (TRX)', None, 'Political Science', 1), ('Suspension Trainer (TRX)', 'Sunday', 'Technician', 1), ('Suspension Trainer (TRX)', 'Wednesday', 'Technician', 1), ('Suspension Trainer (TRX)', None, 'Technician', 2), ('Suspension Trainer (TRX)', None, None, 14), ('Treadmill', 'Monday', 'Administrative Staff', 1), ('Treadmill', None, 'Administrative Staff', 1), ('Treadmill', 'Friday', 'Economics', 1), ('Treadmill', None, 'Economics', 1), ('Treadmill', 'Monday', 'Financial Officer', 1), ('Treadmill', 'Saturday', 'Financial Officer', 1), ('Treadmill', None, 'Financial Officer', 2), ('Treadmill', 'Wednesday', 'History', 1), ('Treadmill', None, 'History', 1), ('Treadmill', 'Tuesday', 'Librarian', 1), ('Treadmill', None, 'Librarian', 1), ('Treadmill', 'Friday', 'Physics', 1), ('Treadmill', None, 'Physics', 1), ('Treadmill', 'Sunday', 'Technician', 1), ('Treadmill', None, 'Technician', 1), ('Treadmill', None, None, 8), ('Vibrating Fitness Roller', 'Wednesday', 'Engineering', 1), ('Vibrating Fitness Roller', None, 'Engineering', 1), ('Vibrating Fitness Roller', 'Monday', 'Family', 1), ('Vibrating Fitness Roller', 'Wednesday', 'Family', 1), ('Vibrating Fitness Roller', None, 'Family', 2), ('Vibrating Fitness Roller', 'Friday', 'Financial Officer', 1), ('Vibrating Fitness Roller', 'Wednesday', 'Financial Officer', 1), ('Vibrating Fitness Roller', None, 'Financial Officer', 2), ('Vibrating Fitness Roller', 'Friday', 'Librarian', 1), ('Vibrating Fitness Roller', None, 'Librarian', 1), ('Vibrating Fitness Roller', 'Thursday', 'Physics', 1), ('Vibrating Fitness Roller', None, 'Physics', 1), ('Vibrating Fitness Roller', 'Friday', 'Political Science', 1), ('Vibrating Fitness Roller', 'Saturday', 'Political Science', 1), ('Vibrating Fitness Roller', None, 'Political Science', 2), ('Vibrating Fitness Roller', 'Friday', 'Security Officer', 1), ('Vibrating Fitness Roller', None, 'Security Officer', 1), ('Vibrating Fitness Roller', None, None, 10), ('Weightlifting Belt', 'Sunday', 'Computer Science', 1), ('Weightlifting Belt', None, 'Computer Science', 1), ('Weightlifting Belt', 'Saturday', 'Family', 1), ('Weightlifting Belt', 'Thursday', 'Family', 1), ('Weightlifting Belt', None, 'Family', 2), ('Weightlifting Belt', 'Thursday', 'History', 1), ('Weightlifting Belt', None, 'History', 1), ('Weightlifting Belt', 'Friday', 'Research Assistant', 1), ('Weightlifting Belt', None, 'Research Assistant', 1), ('Weightlifting Belt', None, None, 5), ('Weightlifting Gloves', 'Friday', 'Biology', 1), ('Weightlifting Gloves', None, 'Biology', 1), ('Weightlifting Gloves', 'Friday', 'Computer Science', 1), ('Weightlifting Gloves', 'Tuesday', 'Computer Science', 1), ('Weightlifting Gloves', None, 'Computer Science', 2), ('Weightlifting Gloves', 'Friday', 'Economics', 2), ('Weightlifting Gloves', 'Monday', 'Economics', 1), ('Weightlifting Gloves', 'Saturday', 'Economics', 1), ('Weightlifting Gloves', 'Sunday', 'Economics', 1), ('Weightlifting Gloves', 'Thursday', 'Economics', 1), ('Weightlifting Gloves', None, 'Economics', 6), ('Weightlifting Gloves', 'Tuesday', 'English Literature', 1), ('Weightlifting Gloves', None, 'English Literature', 1), ('Weightlifting Gloves', 'Monday', 'Family', 3), ('Weightlifting Gloves', 'Saturday', 'Family', 1), ('Weightlifting Gloves', 'Tuesday', 'Family', 1), ('Weightlifting Gloves', 'Wednesday', 'Family', 4), ('Weightlifting Gloves', None, 'Family', 9), ('Weightlifting Gloves', 'Saturday', 'Financial Officer', 1), ('Weightlifting Gloves', None, 'Financial Officer', 1), ('Weightlifting Gloves', 'Friday', 'History', 2), ('Weightlifting Gloves', 'Thursday', 'History', 1), ('Weightlifting Gloves', 'Wednesday', 'History', 2), ('Weightlifting Gloves', None, 'History', 5), ('Weightlifting Gloves', 'Monday', 'Librarian', 1), ('Weightlifting Gloves', 'Sunday', 'Librarian', 1), ('Weightlifting Gloves', None, 'Librarian', 2), ('Weightlifting Gloves', 'Friday', 'Mathematics', 1), ('Weightlifting Gloves', None, 'Mathematics', 1), ('Weightlifting Gloves', 'Friday', 'Physics', 1), ('Weightlifting Gloves', None, 'Physics', 1), ('Weightlifting Gloves', 'Saturday', 'Political Science', 1), ('Weightlifting Gloves', None, 'Political Science', 1), ('Weightlifting Gloves', None, None, 30), (None, None, None, 413)]
        
        result = self.cursor.fetchall()
        
        try:
            self.assertCountEqual(result,result_intermediate,"Incorrect Query")
        except:
            raise Exception("Incorrect Query")
        
    @weight(5)
    def test_query_trigger(self):
        """Create a row level  trigger that no update can reduce an employee salary."""
        self.cursor.execute("drop trigger if exists NoLowerSalary")
        self.cursor.execute(self.queries.query3)
        self.cursor.execute("update employee set salary_hour = 10 where card_id = 20;")
        self.connection.commit()
        self.cursor.execute("select salary_hour from employee where card_id = 20;")

        result_intermediate = 19.00
        
        result = self.cursor.fetchall()[0][0]
        
        try:
            self.assertEqual(result,result_intermediate,"Incorrect Query")
        except:
            raise Exception("Incorrect Trigger, Trigger didn't execute to prevent update")

        self.cursor.execute("update employee set salary_hour = 21 where card_id = 20;")
        self.connection.commit()
        self.cursor.execute("select salary_hour from employee where card_id = 20;")

        result_intermediate = 21.00
        
        result = self.cursor.fetchall()[0][0]
        
        try:
            self.assertEqual(result,result_intermediate,"Incorrect Query")
        except:
            raise Exception("Incorrect Trigger, Trigger executed when not supposed to")

        self.cursor.execute("update employee set salary_hour = 19 where card_id = 20;")
        self.connection.commit()
        self.cursor.execute("select salary_hour from employee where card_id = 20;")

        result_intermediate = 21.00
        
        result = self.cursor.fetchall()[0][0]
        
        try:
            self.assertEqual(result,result_intermediate,"Incorrect Query")
        except:
            raise Exception("Incorrect Trigger, Trigger did not prevent update")
        
        self.cursor.execute("drop trigger if exists NoLowerSalary")
        self.cursor.execute("update employee set salary_hour = 19 where card_id = 20;")
        self.connection.commit()

        
    @weight(5)
    def test_query_constraints(self):
        """Create a tuple level check constraint  that checks that all employees make atleast 12 dollars per hour"""

        self.cursor.execute("select count(*) from INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME ='chk_salary_range' and CONSTRAINT_SCHEMA = 'cs220p';")
        result_count = self.cursor.fetchall()[0][0]
        if result_count > 0:
            self.cursor.execute("alter table employee drop constraint chk_salary_range;")
        
        self.cursor.execute(self.queries.query4)

        try:
            self.cursor.execute("insert into employee values(201,181,'8am-4pm','student',11.00);")
            raise Exception("Incorrect Constraint")
        except mysql.connector.errors.DatabaseError:
            pass
        
        try:
            self.cursor.execute("insert into employee values(201,181,'8am-4pm','student',13.00);")
        except:
            raise Exception("Incorrect Constraint, Salary > 12")
        
    
    @weight(25)
    def test_query_recursive(self):
        """Find the maximum length of supervisor employees for any employee of ARC?"""
        self.cursor.execute(self.queries.query5)
        
        result_intermediate = 3

        result = self.cursor.fetchall()[0][0]
        
        try:
            self.assertEqual(result,result_intermediate,"Incorrect Query")
        except:
            raise Exception("Incorrect Query")


    @weight(15)
    def test_query_ranking(self):
        """Find the 2nd youngest employee who earns the most salary in ARC"""
        self.cursor.execute(self.queries.query6)
        
        result_intermediate = [('Eulah Reynolds DDS',)]
        
        result = self.cursor.fetchall()
        
        try:
            self.assertCountEqual(result,result_intermediate,"Incorrect Query")
        except:
            raise Exception("Incorrect Query")